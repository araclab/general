A  Bayesian latent class model (BLCM) to systematically integrate multiple accessory elements for probabilistic assignment of host-origins.

### Introduction
 
Detection of mobile genetic elements in conjunction with core-genome phylogenetics may identify zoonotic spillover and host switch events. We applied Bayesian latent class model approach that assumes the host-origin for each isolate is in an unobserved class of human, turkey, pork and chicken, with further stratification into three major clades based on core phylogeny. 

BLCM uses multivariate binary responses that indicate presence or absence of 18 host-associated accessory elements, identified previously, to infer the latent host-origins. The latent classes and model parameters can be learned in an unsupervised fashion or using a training set. Markov chain Monte Carlo algorithms are used to iteratively produce samples from the posterior distribution of the unobserved host-origins, based on which we calculate posterior probabilities of host-origins for each isolate.

### Requirement
- R => v.3.3.1
- JAGS => v.4.2.0

### Input format
A matrix with Order of the columns needs to be kept the same as below:

| Column Name | Description |
| --- | --- |
| ID | Isolate/Genome unique Identifier |
| training | 0/1, if its a genome from the training then the value is1, else 0 |
| MLST | multi locus sequence type number |
| human_CH1 | 0/1, if the isolation source of the genome is 'human' and its clade CH1 in the all Ecoli MLST phylogeny then 1, else 0 |
| human_CH2 | 0/1, if the isolation source of the genome is 'human' and its clade CH2 in the all Ecoli MLST phylogeny then 1, else 0 |
| human_CM1 | 0/1, if the isolation source of the genome is 'human' and its clade CM1 in the all Ecoli MLST phylogeny then 1, else 0 |
| chicken_CH1 | 0/1, if the isolation source of the genome is 'chicken' and its clade CH1 in the all Ecoli MLST phylogeny then 1, else 0 |
| chicken_CH2 | 0/1, if the isolation source of the genome is 'chicken' and its clade CH2 in the all Ecoli MLST phylogeny then 1, else 0 |
| chicken_CM1 | 0/1, if the isolation source of the genome is 'chicken' and its clade CM1 in the all Ecoli MLST phylogeny then 1, else 0 |
| turkey_CH1 | 0/1, if the isolation source of the genome is 'turkey' and its clade CH1 in the all Ecoli MLST phylogeny then 1, else 0 |
| turkey_CH2 | 0/1, if the isolation source of the genome is 'turkey' and its clade CH2 in the all Ecoli MLST phylogeny then 1, else 0 |
| turkey_CM1 | 0/1, if the isolation source of the genome is 'turkey' and its clade CM1 in the all Ecoli MLST phylogeny then 1, else 0 |
| pork | 0/1, if the isolation source of the genome is 'pork' then 1, else 0 |
| CH1 | 0/1, if the MLST is in clade CH1 in the all Ecoli MLST phylogeny then 1, else 0 |
| CH2 | 0/1, if the MLST is in clade CH2 in the all Ecoli MLST phylogeny then 1, else 0 |
| CM1 | 0/1, if the MLST is in clade CM1 in the all Ecoli MLST phylogeny then 1, else 0 |
| EL2 | 0/1, if the element was found in genome then 1, else 0 |
| EL3 | 0/1, if the element was found in genome then 1, else 0 |
| EL40 | 0/1, if the element was found in genome then 1, else 0 |
| EL35 | 0/1, if the element was found in genome then 1, else 0 |
| EL44 | 0/1, if the element was found in genome then 1, else 0 |
| EL45 | 0/1, if the element was found in genome then 1, else 0 |
| EL46 | 0/1, if the element was found in genome then 1, else 0 |
| EL18 | 0/1, if the element was found in genome then 1, else 0 |
| EL19 | 0/1, if the element was found in genome then 1, else 0 |
| EL36 | 0/1, if the element was found in genome then 1, else 0 |
| EL37 | 0/1, if the element was found in genome then 1, else 0 |
| EL38 | 0/1, if the element was found in genome then 1, else 0 |
| EL39 | 0/1, if the element was found in genome then 1, else 0 |
| EL41 | 0/1, if the element was found in genome then 1, else 0 |
| EL42 | 0/1, if the element was found in genome then 1, else 0 |
| EL43 | 0/1, if the element was found in genome then 1, else 0 |
| EL50 | 0/1, if the element was found in genome then 1, else 0 |

### Output format

|  Column Name | Description |
| --- | --- |
| Output ID |  ID generated by the script (ignore this column) |
| pred_human_CM1 | Positive Predictive Value for the genome to have a human source in clade CM1 |
| pred_human_CH1 | Positive Predictive Value for the genome to have a human source in clade CH1 |
| pred_human_CH2 | Positive Predictive Value for the genome to have a human source in clade CH2 |
| pred_chicken_CM1 | Positive Predictive Value for the genome to have a chicken source in clade CM1 |
| pred_chicken_CH1 | Positive Predictive Value for the genome to have a chicken source in clade CH1 |
| pred_chicken_CH2 | Positive Predictive Value for the genome to have a chicken source in clade CH2 |
| pred_turkey_CM1 | Positive Predictive Value for the genome to have a turkey source in clade CM1 |
| pred_turkey_CH1 | Positive Predictive Value for the genome to have a turkey source in clade CH1 |
| pred_turkey_CH2 | Positive Predictive Value for the genome to have a turkey source in clade CH2 |
| pred_pork | Positive Predictive Value for the genome to have a pork source |

 The rest of the columns are the same as the input file.
 
 To get the host source prediction for a genome, sum the Positive Predictive Value for that host. 

### Usage

Rscript hostelement_blca.R -i INPUT_CSV -o OUTPUT_FOLDER

### Result Interpretation
To obtain a dichotomous classification (i.e., meat or human origin), we apply a user-defined probability thresholds of ≥ 0.80 for positive and ≤ 0.20 for negative; probabilities between these two values were considered indeterminate. 

### Citation
If you use BLCM - Host Elements, please cite:

[Using source-associated mobile genetic elements to identify zoonotic extraintestinal E.coli infections](https://www.sciencedirect.com/science/article/pii/S2352771423000381)

```
Cindy M. Liu, Maliha Aziz, Daniel E. Park, Zhenke Wu, Marc Stegger, Mengbing Li, Yashan Wang, Kara Schmidlin, Timothy J. Johnson, Benjamin J. Koch, Bruce A. Hungate, Lora Nordstrom, Lori Gauld, Brett Weaver, Diana Rolland, Sally Statham, Brantley Hall, Sanjeev Sariya, Gregg S. Davis, Paul S. Keim, James R. Johnson, Lance B. Price,
Using source-associated mobile genetic elements to identify zoonotic extraintestinal E. coli infections,
One Health, 2023, 100518, ISSN 2352-7714, https://doi.org/10.1016/j.onehlt.2023.100518.
```

